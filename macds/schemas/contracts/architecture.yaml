name: architecture
version: "1.0"
description: Contract for architecture design

input:
  type: object
  required:
    - request_id
    - requirements
  properties:
    request_id:
      type: string
    requirements:
      type: array
      items:
        type: object
    existing_architecture:
      type: string
      description: Existing architecture document if any
    constraints:
      type: array
      items:
        type: string

output:
  type: object
  required:
    - request_id
    - components
    - invariants
    - design_decisions
    - api_contracts
  properties:
    request_id:
      type: string
    components:
      type: array
      items:
        type: object
        required:
          - name
          - responsibility
        properties:
          name:
            type: string
          responsibility:
            type: string
          interfaces:
            type: array
            items:
              type: string
          dependencies:
            type: array
            items:
              type: string
    invariants:
      type: array
      items:
        type: string
      description: Architectural rules that must always hold
    design_decisions:
      type: array
      items:
        type: object
        properties:
          id:
            type: string
            pattern: "^DD-[0-9]{8}-[0-9]{3}$"
          decision:
            type: string
          rationale:
            type: string
          alternatives:
            type: array
            items:
              type: string
          status:
            type: string
            enum: [proposed, accepted, rejected, superseded]
    api_contracts:
      type: array
      items:
        type: object
        properties:
          component:
            type: string
          interface:
            type: string
          version:
            type: string
          methods:
            type: array
    risks:
      type: array
      items:
        type: string

validation_rules:
  - id: ARCH-001
    severity: error
    condition: "len(components) > 0"
    message: Architecture must define at least one component
  - id: ARCH-002
    severity: warning
    condition: "len(invariants) > 0"
    message: Architecture should define invariants
  - id: ARCH-003
    severity: warning
    condition: "no_circular_dependencies(components)"
    message: Components should not have circular dependencies
